\section{Result and Discussion} 
\label{chap:results}

\subsection{ICL Performance}

\begin{table*}[t]
\scriptsize
\centering
\caption{The performance on sentiment analysis task with and without attacks on ICL. The row identified as `Clean' in gray color represents the accuracy with clean in-context demos. Other rows illustrate the accuracies with adversarial in-context demos. The details of the baselines in green color are present in Section \ref{text: baseline}. Specifically, we employ TextAttack (TA) \cite{morris2020textattack} following the attack in \cite{wang2023adversarial} as the most closely related baseline for our attack (GGI). The accuracies of positive (\textcolor{red}{P}) and negative (\textcolor{blue}{N}) sentiments are reported separately to highlight the effectiveness of our hijacking attack. \label{tab:Sen_acc}}
\begin{tabular}{p{1.4cm}|c|p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}|p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}p{0.55cm}}
\hline
\multirow{3}{*}{\textbf{Model}}                 & \multirow{3}{*}{\textbf{Method}} & \multicolumn{6}{c|}{\textbf{SST-2}}    & \multicolumn{6}{c}{\textbf{RT}}    \\ 
                                                &  & \multicolumn{2}{c}{2-shots}                                  & \multicolumn{2}{c}{4-shots}                                  &\multicolumn{2}{c}{8-shots}             & \multicolumn{2}{|c}{2-shots}                                  & \multicolumn{2}{c}{4-shots}                                  & \multicolumn{2}{c}{8-shots}             \\ 
                                                & \multicolumn{1}{c}{}                                 & \multicolumn{1}{|c}{\textcolor{red}{P}} & \multicolumn{1}{c}{\textcolor{blue}{N}} & \multicolumn{1}{c}{\textcolor{red}{P}} & \multicolumn{1}{c}{\textcolor{blue}{N}} & \multicolumn{1}{c}{\textcolor{red}{P}} & \multicolumn{1}{c}{\textcolor{blue}{N}} & \multicolumn{1}{|c}{\textcolor{red}{P}} & \multicolumn{1}{c}{\textcolor{blue}{N}} & \multicolumn{1}{c}{\textcolor{red}{P}} & \multicolumn{1}{c}{\textcolor{blue}{N}} & \multicolumn{1}{c}{\textcolor{red}{P}} & \multicolumn{1}{c}{\textcolor{blue}{N}} \\ \hline
                                                	
 \multirow{5}{*}{GPT2-XL}                        &  \cellcolor{verlightgray}Clean & \multicolumn{1}{c}{\cellcolor{verlightgray}94.7}      &\multicolumn{1}{c}{\cellcolor{verlightgray}52.2 }    & \multicolumn{1}{c}{\cellcolor{verlightgray}88.6 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}49.4  }    & \multicolumn{1}{c}{\cellcolor{verlightgray}91.6 }     & \multicolumn{1}{c|}{\cellcolor{verlightgray}69.0 }     & \multicolumn{1}{c}{\cellcolor{verlightgray}93.3 }    & \multicolumn{1}{c}{\cellcolor{verlightgray}54.7}                                                      &\multicolumn{1}{c}{\cellcolor{verlightgray}88.6}     & \multicolumn{1}{c}{\cellcolor{verlightgray}76.9 }    & \multicolumn{1}{c}{\cellcolor{verlightgray}90.2 }    &\multicolumn{1}{c}{\cellcolor{verlightgray}80.5 }    \\ 
                                                & Square  \cellcolor{verylightgreen}   &\multicolumn{1}{c}{\cellcolor{verylightgreen}99.4}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}2.0 }  &\multicolumn{1}{c}{\cellcolor{verylightgreen}99.8}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}4.2 }     & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.4 }   & \multicolumn{1}{c|}{\cellcolor{verylightgreen}11.0 }    &\multicolumn{1}{c}{\cellcolor{verylightgreen}99.8 }  &\multicolumn{1}{c}{\cellcolor{verylightgreen}1.5 }     & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}4.1 }    & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.3}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}7.5 }    \\ 
                                                &\cellcolor{verylightgreen}Greedy                                                &\multicolumn{1}{c}{\cellcolor{verylightgreen}100 }    & \multicolumn{1}{c}{\cellcolor{verylightgreen}10.8}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}100 }    &\multicolumn{1}{c}{\cellcolor{verylightgreen}6.2 }     & \multicolumn{1}{c}{\cellcolor{verylightgreen}100 }    &\multicolumn{1}{c|}{\cellcolor{verylightgreen}0.2 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}100 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}5.3 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}100 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}2.8}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0 }      \\ 
                                                &\cellcolor{verylightgreen}TA                                               &\multicolumn{1}{c}{\cellcolor{verylightgreen}95.0}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}2.2}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.8 }    &\multicolumn{1}{c}{\cellcolor{verylightgreen}17.8 }     & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.6 }    &\multicolumn{1}{c|}{\cellcolor{verylightgreen}21.6 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}95.9 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}8.1 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}96.3 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}41.3}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}96.4}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}47.3 }      \\ 
                                                & \textbf{ \cellcolor{pink}GGI}   &\multicolumn{1}{c}{\cellcolor{pink}\textbf {100} }     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {1.2} }  & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100} }   &\multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100 } }   & \multicolumn{1}{c|}{\cellcolor{pink}\textbf {0.0 } }     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100} }& \multicolumn{1}{c}{\cellcolor{pink}\textbf {2.8} }  & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100} }   & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}      & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100 }}    & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}      \\ \hline

{\multirow{5}{*}{OPT-2.7b}} &\cellcolor{verlightgray}Clean              & \multicolumn{1}{c}{\cellcolor{verlightgray}98.5 }    & \multicolumn{1}{c}{\cellcolor{verlightgray}38.6}   &\multicolumn{1}{c}{\cellcolor{verlightgray}85.6 }  & \multicolumn{1}{c}{\cellcolor{verlightgray}62.8} &\multicolumn{1}{c}{\cellcolor{verlightgray}58.4}  & \multicolumn{1}{c|}{\cellcolor{verlightgray}76.4}     & \multicolumn{1}{c}{\cellcolor{verlightgray}98.1 }  & \multicolumn{1}{c}{\cellcolor{verlightgray}36.6}   &\multicolumn{1}{c}{\cellcolor{verlightgray}81.2 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}68.4 } & \multicolumn{1}{c}{\cellcolor{verlightgray}57.8 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}89.6}   \\  
                          & \cellcolor{verylightgreen}Square                                                & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0 }   &\multicolumn{1}{c}{\cellcolor{verylightgreen}100}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}     & \multicolumn{1}{c|}{\cellcolor{verylightgreen}1.8 }    & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}1.3 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0 }   &\multicolumn{1}{c}{\cellcolor{verylightgreen}99.6 } & \multicolumn{1}{c}{\cellcolor{verylightgreen}7.5 }   \\ 
\multicolumn{1}{l|}{}                          &\cellcolor{verylightgreen}Greedy    & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0}       & \multicolumn{1}{c}{\cellcolor{verylightgreen}100 }    &\multicolumn{1}{c|}{\cellcolor{verylightgreen}0.0 }      & \multicolumn{1}{c}{\cellcolor{verylightgreen}100 }  & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.4}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.2 }      & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0 }      \\ 
                        &\cellcolor{verylightgreen}TA                                               &\multicolumn{1}{c}{\cellcolor{verylightgreen}99.6}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}13.8}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.8 }    &\multicolumn{1}{c}{\cellcolor{verylightgreen}26.8 }     & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.0 }    &\multicolumn{1}{c|}{\cellcolor{verylightgreen}7.2 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}97.6 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}52.9 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}97.2 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}59.7}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.4}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}6.8 }      \\ 
                         & \textbf{\cellcolor{pink}GGI}   & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100} }   & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100 } }    & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0}}       & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}    & \multicolumn{1}{c|}{\cellcolor{pink}\textbf {0.0}}        & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}   &\multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}      &\multicolumn{1}{c}{\cellcolor{pink}\textbf {100 } }&\multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}       & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100} }     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0} }       \\ \hline
                         
{\multirow{5}{*}{OPT-6.7b}} &\cellcolor{verlightgray}Clean              & \multicolumn{1}{c}{\cellcolor{verlightgray}69.4 }    & \multicolumn{1}{c}{\cellcolor{verlightgray}87.8}   &\multicolumn{1}{c}{\cellcolor{verlightgray}70.2 }  & \multicolumn{1}{c}{\cellcolor{verlightgray}93.8} &\multicolumn{1}{c}{\cellcolor{verlightgray}77.8}  & \multicolumn{1}{c|}{\cellcolor{verlightgray}93.0}     & \multicolumn{1}{c}{\cellcolor{verlightgray}84.4 }  & \multicolumn{1}{c}{\cellcolor{verlightgray}91.4}   &\multicolumn{1}{c}{\cellcolor{verlightgray}84.4 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}93.1 } & \multicolumn{1}{c}{\cellcolor{verlightgray}88.6 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}92.8}   \\  
                          & \cellcolor{verylightgreen}Square                                                & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.2 }    & \multicolumn{1}{c}{\cellcolor{verylightgreen}31.4 }   &\multicolumn{1}{c}{\cellcolor{verylightgreen}93.8}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}72.2 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.6}     & \multicolumn{1}{c|}{\cellcolor{verylightgreen}29.0 }    & \multicolumn{1}{c}{\cellcolor{verylightgreen}98.1}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}42.2 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}97.0}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}68.7 }   &\multicolumn{1}{c}{\cellcolor{verylightgreen}99.4 } & \multicolumn{1}{c}{\cellcolor{verylightgreen}33.2 }   \\ 
\multicolumn{1}{l|}{}                          &\cellcolor{verylightgreen}Greedy    & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}25.0}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}97.8}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}39.0 }       & \multicolumn{1}{c}{\cellcolor{verylightgreen}100 }    &\multicolumn{1}{c|}{\cellcolor{verylightgreen}2.0 }      & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.4 }  & \multicolumn{1}{c}{\cellcolor{verylightgreen}31.7}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.8}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}4.7 }      & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.8 }      \\ 
                        &\cellcolor{verylightgreen}TA                                               &\multicolumn{1}{c}{\cellcolor{verylightgreen}94.8}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}80.8}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}54.8 }    &\multicolumn{1}{c}{\cellcolor{verylightgreen}98.6 }     & \multicolumn{1}{c}{\cellcolor{verylightgreen}91.6 }    &\multicolumn{1}{c|}{\cellcolor{verylightgreen}89.4 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}92.5 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}86.1 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}77.6 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}96.4}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}94.0}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}86.3 }      \\ 
                         & \textbf{\cellcolor{pink}GGI}   & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100} }   & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {98.4 } }    & \multicolumn{1}{c}{\cellcolor{pink}\textbf {2.0}}       & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}    & \multicolumn{1}{c|}{\cellcolor{pink}\textbf {0.2}}        & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}   &\multicolumn{1}{c}{\cellcolor{pink}\textbf {2.6 }}      &\multicolumn{1}{c}{\cellcolor{pink}\textbf {99.8 } }&\multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}       & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100} }     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.2} }       \\ \hline
{\multirow{5}{*}{Vicuna-7b}}      & \cellcolor{verlightgray}Clean                & \multicolumn{1}{c}{\cellcolor{verlightgray}91.4 }    & \multicolumn{1}{c}{\cellcolor{verlightgray}81.2 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}88.2 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}81.4 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}94.6}   & \multicolumn{1}{c|}{\cellcolor{verlightgray}82.6}     &                                                    \multicolumn{1}{c}{\cellcolor{verlightgray}84.8}   & \multicolumn{1}{c}{\cellcolor{verlightgray}78.4}   & \multicolumn{1}{c}{\cellcolor{verlightgray}85.9}    & \multicolumn{1}{c}{\cellcolor{verlightgray}80.5 } &\multicolumn{1}{c}{\cellcolor{verlightgray}90.4}    & \multicolumn{1}{c}{\cellcolor{verlightgray}85.4}   \\ 
                          & \cellcolor{verylightgreen}Square                                                & \multicolumn{1}{c}{\cellcolor{verylightgreen}89.2}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}84.4}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}86.6}     &\multicolumn{1}{c}{\cellcolor{verylightgreen}85.8}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}94.0 }   & \multicolumn{1}{c|}{\cellcolor{verylightgreen}83.8 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}85.9}  & \multicolumn{1}{c}{\cellcolor{verylightgreen}85.4}   &\multicolumn{1}{c}{\cellcolor{verylightgreen}84.6}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}88.6}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}91.6}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}88.4}    \\ 
\multicolumn{1}{l|}{}                          & \cellcolor{verylightgreen}Greedy                                                & \multicolumn{1}{c}{\cellcolor{verylightgreen}93.0}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}83.4 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}88.4}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}87.0}        & \multicolumn{1}{c}{\cellcolor{verylightgreen}94.6}     & \multicolumn{1}{c|}{\cellcolor{verylightgreen}80.0}        & \multicolumn{1}{c}{\cellcolor{verylightgreen}91.2}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}82.8}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}86.9 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}88.7 }       & \multicolumn{1}{c}{\cellcolor{verylightgreen}91.9}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}85.9}        \\ 
                         &\cellcolor{verylightgreen}TA                                               &\multicolumn{1}{c}{\cellcolor{verylightgreen}87.0}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}85.2}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}76.2 }    &\multicolumn{1}{c}{\cellcolor{verylightgreen}88.2 }     & \multicolumn{1}{c}{\cellcolor{verylightgreen}94.2 }    &\multicolumn{1}{c|}{\cellcolor{verylightgreen}80.6 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}83.3 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}84.2 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}79.6 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}88.6}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}92.1}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}84.4 }      \\ 
                         & \textbf{\cellcolor{pink}GGI}   &\multicolumn{1}{c}{\cellcolor{pink}\textbf {90.6 }}  & \multicolumn{1}{c}{\cellcolor{pink}\textbf {42.2}}     &\multicolumn{1}{c}{\cellcolor{pink}\textbf {96.4}}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {23.2} }     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}   &\multicolumn{1}{c|}{\cellcolor{pink}\textbf {0.8 } }     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {87.6 }} & \multicolumn{1}{c}{\cellcolor{pink}\textbf {36.4 }}       & \multicolumn{1}{c}{\cellcolor{pink}\textbf {95.1} } & \multicolumn{1}{c}{\cellcolor{pink}\textbf {35.7} }      & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100 }}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.2 } }      \\ \hline   
{\multirow{5}{*}{LLaMA-7b}}      & \cellcolor{verlightgray}Clean                & \multicolumn{1}{c}{\cellcolor{verlightgray}81.4 }    & \multicolumn{1}{c}{\cellcolor{verlightgray}86.3 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}74.4 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}91.9 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}82.7}   & \multicolumn{1}{c|}{\cellcolor{verlightgray}92.4}     &                                                    \multicolumn{1}{c}{\cellcolor{verlightgray}86.0}   & \multicolumn{1}{c}{\cellcolor{verlightgray}83.6}   & \multicolumn{1}{c}{\cellcolor{verlightgray}81.9}    & \multicolumn{1}{c}{\cellcolor{verlightgray}91.6 } &\multicolumn{1}{c}{\cellcolor{verlightgray}89.3}    & \multicolumn{1}{c}{\cellcolor{verlightgray}97.8}   \\ 
                          & \cellcolor{verylightgreen}Square                                                & \multicolumn{1}{c}{\cellcolor{verylightgreen}86.8}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}80.0}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}96.8}     &\multicolumn{1}{c}{\cellcolor{verylightgreen}58.6}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}98.0 }   & \multicolumn{1}{c|}{\cellcolor{verylightgreen}56.4 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}86.9 }  & \multicolumn{1}{c}{\cellcolor{verylightgreen}57.4}   &\multicolumn{1}{c}{\cellcolor{verylightgreen}97.4}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}50.1}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}97.8}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}57.4}    \\ 
\multicolumn{1}{l|}{}                          & \cellcolor{verylightgreen}Greedy                                                & \multicolumn{1}{c}{\cellcolor{verylightgreen}95.0}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}47.6 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0}        & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}     & \multicolumn{1}{c|}{\cellcolor{verylightgreen}0.0}        & \multicolumn{1}{c}{\cellcolor{verylightgreen}88.9}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}2.8}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.8 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0 }       & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0}        \\ 
                         &\cellcolor{verylightgreen}TA                                               &\multicolumn{1}{c}{\cellcolor{verylightgreen}87.2}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}77.8}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}93.8 }    &\multicolumn{1}{c}{\cellcolor{verylightgreen}69.0 }     & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.8 }    &\multicolumn{1}{c|}{\cellcolor{verylightgreen}8.8 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}83.1 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}57.4 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}94.2 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}68.9}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}99.6}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}3.80 }      \\ 
                         & \textbf{\cellcolor{pink}GGI}   &\multicolumn{1}{c}{\cellcolor{pink}\textbf {100 } } & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.4} }    &\multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0}}      & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}   &\multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 } }     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {96.8 }} & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 } }      & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}  & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 } }      & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100 }}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}       \\ \hline         
{\multirow{5}{*}{LLaMA-13b}}      & \cellcolor{verlightgray}Clean                & \multicolumn{1}{c}{\cellcolor{verlightgray}97.8 }    & \multicolumn{1}{c}{\cellcolor{verlightgray}76.4 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}95.6 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}88.0 }   & \multicolumn{1}{c}{\cellcolor{verlightgray}95.8}   & \multicolumn{1}{c|}{\cellcolor{verlightgray}90.0}     &                                                    \multicolumn{1}{c}{\cellcolor{verlightgray}94.2}   & \multicolumn{1}{c}{\cellcolor{verlightgray}84.8}   & \multicolumn{1}{c}{\cellcolor{verlightgray}92.7}    & \multicolumn{1}{c}{\cellcolor{verlightgray}92.1 } &\multicolumn{1}{c}{\cellcolor{verlightgray}91.4}    & \multicolumn{1}{c}{\cellcolor{verlightgray}91.9}   \\ 
                          & \cellcolor{verylightgreen}Square                                                & \multicolumn{1}{c}{\cellcolor{verylightgreen}98.4}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}72.8}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}98.2}     &\multicolumn{1}{c}{\cellcolor{verylightgreen}78.4}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}97.8 }   & \multicolumn{1}{c|}{\cellcolor{verylightgreen}85.4 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}93.6 }  & \multicolumn{1}{c}{\cellcolor{verylightgreen}87.4}   &\multicolumn{1}{c}{\cellcolor{verylightgreen}94.4}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}84.1}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}94.2}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}87.6}    \\ 
\multicolumn{1}{l|}{}                          & \cellcolor{verylightgreen}Greedy                                                & \multicolumn{1}{c}{\cellcolor{verylightgreen}98.0}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}41.4 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}3.0}        & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}     & \multicolumn{1}{c|}{\cellcolor{verylightgreen}0.0}        & \multicolumn{1}{c}{\cellcolor{verylightgreen}55.9}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}11.3}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}92.9}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.0 }       & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}0.4}        \\ 
                         &\cellcolor{verylightgreen}TA                                               &\multicolumn{1}{c}{\cellcolor{verylightgreen}98.2}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}72.2}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}92.8 }    &\multicolumn{1}{c}{\cellcolor{verylightgreen}92.8 }     & \multicolumn{1}{c}{\cellcolor{verylightgreen}97.5 }    &\multicolumn{1}{c|}{\cellcolor{verylightgreen}87.6 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}94.8 }     &\multicolumn{1}{c}{\cellcolor{verylightgreen}81.8 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}88.0 }   & \multicolumn{1}{c}{\cellcolor{verylightgreen}94.0}   & \multicolumn{1}{c}{\cellcolor{verylightgreen}92.5}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}89.3 }      \\ 
                         & \textbf{\cellcolor{pink}GGI}   &\multicolumn{1}{c}{\cellcolor{pink}\textbf {99.2 }}  & \multicolumn{1}{c}{\cellcolor{pink}\textbf {37.8}}     &\multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {7.2}}      & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100}}   &\multicolumn{1}{c|}{\cellcolor{pink}\textbf {0.0 }}      & \multicolumn{1}{c}{\cellcolor{pink}\textbf {99.1 }}& \multicolumn{1}{c}{\cellcolor{pink}\textbf {3.8 }}       & \multicolumn{1}{c}{\cellcolor{pink}\textbf {86.1}}  & \multicolumn{1}{c}{\cellcolor{pink}\textbf {3.6 }}       & \multicolumn{1}{c}{\cellcolor{pink}\textbf {100 }}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf {0.0 }}       \\ \hline
\end{tabular}
\end{table*}

The rows identified as `Clean' in Table \ref{tab:Sen_acc} and Table \ref{tab:AG_acc} show the ICL performance on the respective tasks when using clean in-context demos. In particular, Table \ref{tab:Sen_acc} presents the accuracies for the generation of positive (\textcolor{red}{P}) and negative (\textcolor{blue}{N}) sentiments in the SST-2 and RT datasets. All the tested LLMs perform well, achieving an average accuracy of 83.6\% on SST-2 and 86.7\% on RT across various in-context few-shot settings. Table \ref{tab:AG_acc} indicates that LLMs with ICL also perform well in the context of multi-class generation on AG's News dataset. The average accuracies stand at 69.1\% for 4-shot settings and 72.3\% for 8-shot settings across various LLMs. Additionally, LLMs with ICL exhibit improved performance with an increased number of in-context demos, particularly achieving best results with 8-shot settings. 

\begin{table*}[t]
\scriptsize
\centering
\caption{The performance of AG's News topic generation task with and without attacks on ICL. The clean and attack accuracies are reported separately for the four topics. These results highlight the effectiveness of our hijacking attacks to induce LLMs to generate the target token, i.e., ``tech'', regardless of the query content. \label{tab:AG_acc}}
\begin{tabular}{>{\centering\arraybackslash}m{1.9cm}|>{\centering\arraybackslash}m{1.9cm}|cccc|cccc}
\hline
\multirow{2}{*}{\textbf{Model}}    & \multirow{2}{*}{\textbf{Method}} & \multicolumn{4}{c|}{\textbf{4-shots}}                                                                     & \multicolumn{4}{c}{\textbf{8-shots}}                                                                     \\ \cline{3-10} 
                          &                         & \multicolumn{1}{c}{word}  & \multicolumn{1}{c}{sports} & \multicolumn{1}{c}{business} & \textbf{tech}  & \multicolumn{1}{c}{word}  & \multicolumn{1}{c}{sports} & \multicolumn{1}{c}{business} & \textbf{tech}  \\ \hline
\multirow{5}{*}{GPT2-XL}  & \cellcolor{verlightgray}Clean                   & \multicolumn{1}{c}{\cellcolor{verlightgray}48.5} & \multicolumn{1}{c}{ \cellcolor{verlightgray}87.0}  & \multicolumn{1}{c}{ \cellcolor{verlightgray}64.9}    &  \cellcolor{verlightgray}71.9 & \multicolumn{1}{c}{ \cellcolor{verlightgray}48.2} & \multicolumn{1}{c}{ \cellcolor{verlightgray}50.6}  & \multicolumn{1}{c}{ \cellcolor{verlightgray}71.0}    &  \cellcolor{verlightgray}83.6  \\ 
                          & \cellcolor{verylightgreen}Square                     & \multicolumn{1}{c}{\cellcolor{verylightgreen}2.0}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}66.0}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}26.8}      & \cellcolor{verylightgreen}96.0   & \multicolumn{1}{c}{\cellcolor{verylightgreen}19.6}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}65.6}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}28.0}      & \cellcolor{verylightgreen}97.2   \\
                         &\cellcolor{verylightgreen}Greedy                     & \multicolumn{1}{c}{\cellcolor{verylightgreen}12.8}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}60.4}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}29.2}      & \cellcolor{verylightgreen}96.4   & \multicolumn{1}{c}{\cellcolor{verylightgreen}8.0}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}21.2}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}10.0}      & \cellcolor{verylightgreen}98.8   \\
                          &\cellcolor{verylightgreen}TA                     & \multicolumn{1}{c}{\cellcolor{verylightgreen}54.8}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}84.0}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}73.2}      & \cellcolor{verylightgreen}82.4   & \multicolumn{1}{c}{\cellcolor{verylightgreen}82.0}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}82.4}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}91.2}      & \cellcolor{verylightgreen}57.6   \\
                          & \cellcolor{pink}\textbf{GGI}                     & \multicolumn{1}{c}{\cellcolor{pink} \textbf{0.0}}     & \multicolumn{1}{c}{\cellcolor{pink} \textbf{2.0}}   & \multicolumn{1}{c}{\cellcolor{pink} \textbf{0.4}}      & \cellcolor{pink}\textbf{100}   & \multicolumn{1}{c}{\cellcolor{pink}\textbf{0.0}}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf{0.0}}      & \multicolumn{1}{c}{\cellcolor{pink}\textbf{0.0}}        & \cellcolor{pink}\textbf{100}   \\ \hline
\multirow{5}{*}{LLaMA-7b} &\cellcolor{verlightgray}Clean                   & \multicolumn{1}{c}{\cellcolor{verlightgray}68.2} & \multicolumn{1}{c}{\cellcolor{verlightgray}96.8}  & \multicolumn{1}{c}{\cellcolor{verlightgray}66.6}    & \cellcolor{verlightgray}49.0 & \multicolumn{1}{c}{\cellcolor{verlightgray}88.6} & \multicolumn{1}{c}{\cellcolor{verlightgray}97.4}  & \multicolumn{1}{c}{\cellcolor{verlightgray}78.2}    & \cellcolor{verlightgray}61.0 \\ 
                          & \cellcolor{verylightgreen}Square                     & \multicolumn{1}{c}{\cellcolor{verylightgreen}78.4}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}98.0}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}76.0}      & \cellcolor{verylightgreen}36.8   & \multicolumn{1}{c}{\cellcolor{verylightgreen}94.4}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}98.0}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}60.0}      & 5\cellcolor{verylightgreen}7.6   \\ 
                         & \cellcolor{verylightgreen}Greedy                     & \multicolumn{1}{c}{\cellcolor{verylightgreen}69.6}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}98.8}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}75.2}      & \cellcolor{verylightgreen}51.6   & \multicolumn{1}{c}{\cellcolor{verylightgreen}89.6}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}100}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}68.4}      & \cellcolor{verylightgreen}73.6   \\ 
                         & \cellcolor{verylightgreen}TA                     & \multicolumn{1}{c}{\cellcolor{verylightgreen}42.4}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}94.8}    & \multicolumn{1}{c}{\cellcolor{verylightgreen}67.6}      & \cellcolor{verylightgreen}32.4   & \multicolumn{1}{c}{\cellcolor{verylightgreen}95.2}     & \multicolumn{1}{c}{\cellcolor{verylightgreen}96.0}      & \multicolumn{1}{c}{\cellcolor{verylightgreen}39.2}      & \cellcolor{verylightgreen}24.8   \\ 
                          & \cellcolor{pink}\textbf{GGI}                     & \multicolumn{1}{c}{\cellcolor{pink}\textbf{0.0}}     & \multicolumn{1}{c}{\cellcolor{pink}\textbf{20.0}}  & \multicolumn{1}{c}{\cellcolor{pink}\textbf{0.00}}        & \cellcolor{pink}\textbf{98.0} & \multicolumn{1}{c}{\cellcolor{pink}\textbf{29.6}}  & \multicolumn{1}{c}{\cellcolor{pink}\textbf{56.0}}   & \multicolumn{1}{c}{\cellcolor{pink}\textbf{0.0}}        & \cellcolor{pink}\textbf{100}   \\ \hline
\end{tabular}
\end{table*}

\begin{table*}[t]
\scriptsize
\centering
\caption{ASR among different datasets, models, and attack methods. Best scores are in bold.}
\begin{tabular}{c|c|ccc|ccc|cc}
\hline
\multirow{2}{*}{\textbf{Model}}                 & \multirow{2}{*}{\textbf{Method}} & \multicolumn{3}{c|}{\textbf{SST-2}}    & \multicolumn{3}{c|}{\textbf{RT}} & \multicolumn{2}{c}{\textbf{AG's News}}   \\ 
                                                &  & 2-shots                                 & 4-shots                                  &8-shots             & 2-shots                                  & 4-shots                                  & 8-shots                                     & 4-shots                                  & 8-shots   \\ \hline
\multirow{4}{*}{GPT2-XL}                       
                                                &\cellcolor{verylightgreen}Square     &\cellcolor{verylightgreen}98.0      &\cellcolor{verylightgreen}97.8     &\cellcolor{verylightgreen}94.2     &\cellcolor{verylightgreen}\textbf{98.7}     &\cellcolor{verylightgreen}97.9    &\cellcolor{verylightgreen}95.9   &\cellcolor{verylightgreen}64.9        &\cellcolor{verylightgreen}65.2          \\ 
                                                &\cellcolor{verylightgreen}Greedy     &\cellcolor{verylightgreen}94.6     &\cellcolor{verylightgreen}96.9   &\cellcolor{verylightgreen}99.9     &\cellcolor{verylightgreen}97.4    &\cellcolor{verylightgreen}98.6      &\cellcolor{verylightgreen}100 &\cellcolor{verylightgreen}    68.3             &\cellcolor{verylightgreen}87.3     \\ 
                                                &\cellcolor{verylightgreen}TA     &\cellcolor{verylightgreen}89.6     &\cellcolor{verylightgreen}91.0   &\cellcolor{verylightgreen}89.0   &\cellcolor{verylightgreen}85.9    &\cellcolor{verylightgreen}77.5     &\cellcolor{verylightgreen}74.6  &\cellcolor{verylightgreen}15.1            &\cellcolor{verylightgreen}15.9    \\ 
                                                & \cellcolor{pink}\textbf{GGI}           & \cellcolor{pink}\textbf{99.4}    & \cellcolor{pink}\textbf{100}    & \cellcolor{pink}\textbf{100}    & \cellcolor{pink}98.6        & \cellcolor{pink}\textbf{100}     & \cellcolor{pink}\textbf{100}&      \cellcolor{pink}\textbf{99.1}          & \cellcolor{pink}\textbf{100}     \\ \hline
{\multirow{4}{*}{LLaMA-7b}}     
                                &\cellcolor{verylightgreen}Square    &\cellcolor{verylightgreen}48.1    &\cellcolor{verylightgreen}65.9   &\cellcolor{verylightgreen}70.6    &\cellcolor{verylightgreen}48.4    &\cellcolor{verylightgreen}69.9   &\cellcolor{verylightgreen}69.7   &\cellcolor{verylightgreen}10.3               &\cellcolor{verylightgreen}15.9 \\ 
\multicolumn{1}{l|}{}           &\cellcolor{verylightgreen}Greedy    &\cellcolor{verylightgreen}64.2     &\cellcolor{verylightgreen}100   &\cellcolor{verylightgreen}100      &\cellcolor{verylightgreen}64.3              &\cellcolor{verylightgreen}99.8      &\cellcolor{verylightgreen}100&\cellcolor{verylightgreen}14.3       &\cellcolor{verylightgreen}22.1               \\ 
                                &\cellcolor{verylightgreen}TA     &\cellcolor{verylightgreen}48.2     &\cellcolor{verylightgreen}59.5   &\cellcolor{verylightgreen}95.4   &\cellcolor{verylightgreen}45.8    &\cellcolor{verylightgreen}58.0     &\cellcolor{verylightgreen}97.8  &\cellcolor{verylightgreen}9.3            &\cellcolor{verylightgreen}6.8    \\ 
                         &\cellcolor{pink} \textbf{GGI}      & \cellcolor{pink}\textbf{97.7}  & \cellcolor{pink}\textbf{100}        & \cellcolor{pink}\textbf{100}  & \cellcolor{pink}\textbf{90.7}      & \cellcolor{pink}\textbf{99.9}      & \cellcolor{pink}\textbf{100}     &\cellcolor{pink}\textbf{82.8}          & \cellcolor{pink}\textbf{77.9}        \\ \hline
\end{tabular}
\label{tab:asr}
\end{table*}

\begin{table*}[t]
\scriptsize
\centering
\caption{The performance of the defenses using ASRs across various LLMs and datasets. Adv denotes our hijacking attack using the adversarial demos. Adv+Clean represents the proposed defense method, leveraging extra clean demos with adversarial demos. The numbers within the parenthesis indicate the reduction in the ASRs after defense. \label{tab:defense}}
\begin{tabular}{c|ccc|ccc|ccc}
\hline
\multirow{3}{*}{\textbf{Model}} & \multicolumn{3}{c|}{\textbf{SST-2}}                                                         & \multicolumn{3}{c|}{\textbf{RT}}                                                           & \multicolumn{3}{c}{\textbf{AG's News}}                                                    \\ 
                       & \multicolumn{1}{c}{\multirow{2}{*}{Adv}} & \multicolumn{2}{c|}{Adv+Clean}        & \multicolumn{1}{c}{\multirow{2}{*}{Adv}} & \multicolumn{2}{c|}{Adv+Clean}        & \multicolumn{1}{c}{\multirow{2}{*}{Adv}} & \multicolumn{2}{c}{Adv+Clean}        \\ 
                       & \multicolumn{1}{c}{}                     & \multicolumn{1}{c}{Preceding} & Proceeding & \multicolumn{1}{c}{}                     & \multicolumn{1}{c}{Preceding} & Proceeding & \multicolumn{1}{c}{}                     & \multicolumn{1}{c}{Preceding} & Proceeding \\ \hline
GPT2-XL                & \multicolumn{1}{c}{100}                     & \multicolumn{1}{c}{100 (-0)}        &     \multicolumn{1}{c|}{99.6 (-0.4)}    & \multicolumn{1}{c}{100}                     & \multicolumn{1}{c}{100 (-0)}        &     \multicolumn{1}{c|}{97.4 (-2.6)}    & \multicolumn{1}{c}{99.1}                     & \multicolumn{1}{c}{75.5 (-23.6)}        &    \multicolumn{1}{c}{80.5 (-18.6)}      \\ 
OPT-6.7b               & \multicolumn{1}{c}{98.2}                     & \multicolumn{1}{c}{44.9 (-53.3)}        &    \multicolumn{1}{c|}{52.5 (-45.7)}    & \multicolumn{1}{c}{99.9}                     & \multicolumn{1}{c}{50.2 (-49.7)}        &    \multicolumn{1}{c|}{57.8 (-42.1)}    & \multicolumn{1}{c}{65.6}                     & \multicolumn{1}{c}{23.5 (-42.1)}        &   \multicolumn{1}{c}{22.5 (-43.1)}     \\ 
LLaMA-7b               & \multicolumn{1}{c}{100}                     & \multicolumn{1}{c}{49.1 (-50.9)}        &    \multicolumn{1}{c|}{98.3 (-1.7)}      & \multicolumn{1}{c}{100}                     & \multicolumn{1}{c}{53.1 (-46.9)}        &     \multicolumn{1}{c|}{99.8 (-0.2)}    & \multicolumn{1}{c}{82.8}                     & \multicolumn{1}{c}{42.2 (-40.6)}        &    \multicolumn{1}{c}{88.2 (+5.4)}      \\  \hline
\end{tabular}
\end{table*}

\subsection{ICL Performance with Hijacking Attack}

While LLMs utilizing ICL show strong performance with clean in-context demos, Tables \ref{tab:Sen_acc} and \ref{tab:AG_acc} reveal that their effectiveness is significantly undermined by hijacking attacks. These attacks manipulate the models to produce target outputs by appending adversarial suffixes to the in-context demos. The baseline attacks successfully induce LLMs to generate the targeted positive sentiment through a few shots of adversarially perturbed demos, as shown in Table \ref{tab:Sen_acc}. As a result, the positive test samples achieve a predominantly higher accuracy than the negative ones. Furthermore, our GGI attack more effectively hijacks LLMs to generate the target output, i.e., exclusively positive sentiment token, regardless of the test query content. The positive test samples achieve almost 100\% accuracy. On the contrary, the negative ones get nearly 0\% accuracy on most settings, as shown in \ref{tab:Sen_acc}. For the more complex multi-class AG's News topic generation task, the effectiveness of those baseline attacks decreases significantly. Especially the TA method is not successful in hijacking LLMs to generate the target token, i.e., `tech'. Only our GGI attack successfully hijacks the LLMs to generate ``tech'' by appending the adversarial suffixes to the in-context demos, as shown in Table \ref{tab:AG_acc}.

In addition to the attack accuracy performance provided in Table \ref{tab:Sen_acc} and \ref{tab:AG_acc}, we present ASRs for various attacks across the three datasets. As outlined in Table \ref{tab:asr}, our GGI attack achieves the highest ASRs, substantiating its highest effectiveness in hijacking the LLM to generate the targeted output. In sentiment analysis tasks like SST-2 and RT, all attacks exhibit high ASRs. While for the more complex multi-class topic generation task, such as AG's News, only our GGI attack achieves high ASRs. This further emphasizes the potential effectiveness of our hijacking attack on more complex generative tasks, such as question answering tasks.

\subsection{Defense Method Performance}

Table \ref{tab:defense} presents ASRs of our hijacking attack when countered with the proposed defense mechanism that uses additional clean demos. The defense method is tested in two different settings. In the Preceding setting, clean demos are placed before the adversarial demos in the sequence $\Tilde{p} = [I; \Tilde{C}; C^\prime; S(x_Q,\_)]$. Conversely, in the Proceeding setting, clean demos are added after the adversarial demos, forming the sequence $\Tilde{p} = [I; C^\prime; \Tilde{C}; S(x_Q,\_)]$. 

The results show a significant decrease in ASRs of our hijacking attack, affirming the effectiveness of the defense method. Notably, the Preceding setting results in considerably lower ASRs compared to the Proceeding setting. This relates to the mechanism through which our hijacking attack induces LLMs to generate target outputs. As depicted in Figure \ref{fig:am_perturb}, the adversarial suffixes divert the LLMs' attention away from the original query. Furthermore, Figure \ref{fig:am_defense} illustrates that the LLM primarily focuses on the initial segments of the demos, which are indicated by a darker green color. Therefore, in the Preceding method, the model shifts its attention to these first few demos, which contain additional clean samples before the adversarial demos. These clean samples effectively re-calibrate and rectify the model's behavior, resulting in a larger reduction in ASRs, as shown in Table \ref{tab:defense}. In contrast, the first few demos remain adversarial in the Proceeding method, rendering it ineffective in defending against the adversarial demonstration attack. 

Furthermore, the results indicate that our proposed defense methods are ineffective on small-sized LLMs, such as the GPT2-XL used in our experiments. We hypothesize that this is due to their limited emergent abilities. In other words, employing additional demos during ICL cannot correct the behavior of small-sized LLMs under hijacking attacks. 

\subsection{Stealthiness of GGI}

The perplexity scores shown in Figure \ref{fig:ppl} for both the baseline and our attacks exhibit minor (non-significant, P-value of 0.329 (0.993) $\gg$ 0.05 cutoff is reported from one-way ANOVA test) increases compared to the score of the clean samples, highlighting the stealth of our proposed word-level adversarial attacks. Specifically, the adversarial triggers learned from our GGI algorithm are imperceptible and maintain the semantic integrity and coherence of the original content, as shown in the examples of Figures \ref{fig:eg_sst2} and \ref{fig:eg_ag}. 

\begin{figure}
\centering
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{fig/ave_ppl_sst.pdf}
  \caption{SST-2}
  \label{fig:sub1}
\end{subfigure}%
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=\linewidth]{fig/ave_ppl_rt.pdf}
  \caption{RT}
  \label{fig:sub2}
\end{subfigure}
\caption{Average perplexity scores reported for LLaMA2-7b on 100 random samples under eight-shots setting from SST-2 (a) and RT (b) derived from three separate runs under various attacks.}
\label{fig:ppl}
\end{figure}

\subsection{Impact of Number of In-context Demos}

We extend our investigation to explore the impact of in-context demos on adversarial ICL attacks. We observe a substantial impact on the attack performance in ICL based on the number of demos employed. As indicated in Tables \ref{tab:Sen_acc} and \ref{tab:AG_acc}, an increase in the number of in-context demos correlates with a higher susceptibility of the attack to hijack LLMs, resulting in the generation of target outputs with greater ease. Specifically, in the 8-shot setting, LLMs consistently exhibit significantly lower accuracies in negative sentiment generation, demonstrating a higher rate of successful attacks compared to the 2-shot and 4-shot settings. Moreover, the attacks demonstrate higher ASRs as the number of in-context demos used in ICL increases, as shown in Table \ref{tab:asr}.

\subsection{Impact of Sizes of LLMs}

\begin{figure} [t]
  \centering
  \includegraphics[width=0.65\linewidth]{fig/modelsize.pdf} 
  \caption{Impact of LLM size on adversarial robustness. ASRs on the AG's News topic generation task using different sizes of OPT models, i.e., OPT-2.7b and OPT-6.7b, with two different few-shot settings. \label{fig:modelsize}}
\end{figure}

Results in Table \ref{tab:asr} reveal that the ASRs on GPT2-XL are significantly higher than those on LLaMA-7b, suggesting that hijacking the larger LLM is more challenging. Here, we continue examining how the size of LLMs influences the performance of hijacking attacks. Table \ref{tab:Sen_acc} illustrates the performance of sentiment analysis tasks with and without attacks on ICL using different sizes of OPT, i.e., OPT-2.7b and OPT-6.7b. These results further highlight that the smaller LLM, i.e., OPT-2.7b, is much easier to be attacked and induced to generate unwanted target outputs, such as `positive', in the sentiment analysis tasks. Figure \ref{fig:modelsize} illustrates our proposed hijacking attack performance using ASR on two OPT models of varying sizes in AG's News topic generation task. It clearly shows that attacking the smaller OPT2-2.7b model achieves a much higher ASR in both settings, confirming our finding and others \cite{wang2023large} that larger models are more resistant to adversarial attacks.


\subsection{Comparison of Hijacking Attacks}

\begin{figure} [t]
  \centering
  \includegraphics[width=0.65\linewidth]{fig/losses.png} 
  \caption{An illustration of the learning objective values during iterations among different attacks on SST2 using GPT2-XL with 8-shots. \label{fig:losses}}
\end{figure}

In contrast to baseline hijacking attacks, i.e., Square and Greedy, our GGI exhibits superior performance in generating targeted outputs, as evidenced by the results in Table \ref{tab:Sen_acc} and \ref{tab:AG_acc}, along with the highest ASRs highlighted in Table \ref{tab:asr}. This underscores the effectiveness of GGI as a more potent method of attack. 

To further illustrate the efficiency of our GGI, we present the objective function values of Eq. \ref{eq:loss} in Figure \ref{fig:losses} for various attack methods. Since our GGI attack enjoys the advantages of both greedy and gradient-based search strategies as depicted in Algorithm \ref{alg}, the values of the object function decrease steadily and rapidly, ultimately reaching the minimum loss value. On the other hand, both the Square and Greedy attacks use a greedy search strategy, with fluctuating results that increase and decrease the loss value, unable to converge to the minimum loss value corresponding to the optimal adversarial suffixes. 

\subsection{Diverting LLM Attention}

\begin{figure*} [t]
\centering 
\begin{subfigure}[b]{\textwidth}
   \includegraphics[width=\linewidth]{fig/attention_map_Clean}
   \caption{}
   \label{fig:am_clean} 
\end{subfigure}

\begin{subfigure}[b]{\textwidth}
   \includegraphics[width=\linewidth]{fig/attention_map_Perturbed}
   \caption{}
   \label{fig:am_perturb}
   \vspace{-0.2cm}
\end{subfigure}
\caption{Attentions maps generated using (a) clean and (b) adversarial perturbed prompts. In (b), the adversarial suffix tokens, i.e., `NULL' and `Remove',  are underlined in red. Darker green colors represent larger attention weights. The prompts are tokenized to mimic the actual inputs to the LLMs. Best viewed in color.}
\end{figure*}

Attempting to interpret the possible mechanism of our hijacking attacks, we show an illustrative example using attention weights from LLaMA-7b on the SST2 task with both clean and perturbed prompts. As depicted in Figure \ref{fig:am_perturb}, the model's attention for generating the sentiment token of the test query has been diverted towards the adversarial suffix tokens `NULL' and `Remove'. Compared to the attention maps using the clean prompt (Figure \ref{fig:am_clean}), these two suffixes attain the largest attention weights represented by the darkest green color. This example illuminates a possible mechanism for why our hijacking attack can induce the LLM to generate the targeted outputs - the adversarial suffixes divert the LLMs' attention away from the original query.

\begin{figure*} [t]
\centering 
\begin{subfigure}[b]{\textwidth}
   \includegraphics[width=\linewidth]{fig/Preceding}
   \caption{}
   \label{fig:am_pre} 
\end{subfigure}

\begin{subfigure}[b]{\textwidth}
   \includegraphics[width=\linewidth]{fig/Proceeding}
   \caption{}
   \label{fig:am_pro}
   \vspace{-0.2cm}
\end{subfigure}
\caption{Attentions maps generated using (a) Preceding and (b) Proceeding defense methods. Best viewed in color.\label{fig:am_defense}}
\end{figure*}

Additionally, Figure \ref{fig:am_defense} illustrates the attention distribution for the perturbed prompts after applying the Preceding and Proceeding defense methods. Notably, in the demos, the model primarily focuses on the front segments of demos, which are indicated by a darker green color. Therefore, the model converts its attention to the front segments, which are the extra clean samples, in the Preceding method. These clean samples effectively re-calibrate and rectify the model's behavior, leading to a significant reduction in ASRs, as shown in Table \ref{tab:defense}. In contrast, the first few demos remain adversarial in the Proceeding method, rendering it ineffective in defending against our attack, as shown in Table \ref{tab:defense}.

Overall, these attention maps visualize how the adversarial suffixes distract LLMs from focusing on the relevant context to generate the unwanted target output and how our proposed defense methods rectify the behavior of LLMs given the extra clean demos. 

\begin{figure*} [t]
  \centering
  \includegraphics[width=\linewidth]{fig/example_sst2.png} 
  \caption{Visualization of an adversarial example generated by baseline and our attacks on SST-2 via attacking LLaMA-7b.\label{fig:eg_sst2}}
\end{figure*}

\begin{figure*} [t]
  \centering
  \includegraphics[width=\linewidth]{fig/example_ag.png} 
  \caption{Visualization of an adversarial example generated by baseline and our attacks on AG's News via attacking LLaMA-7b.\label{fig:eg_ag}}
\end{figure*}
